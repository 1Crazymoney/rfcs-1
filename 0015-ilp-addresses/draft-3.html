<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Payments across payment networks">

    <title>ILP Addresses | Interledger</title>

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles -->
    <link href="/css/monokai-sublime.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Google fonts -->
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,600,700|Droid+Sans+Mono|Titillium+Web:400,300,600' rel='stylesheet' type='text/css'>

    <!-- Font awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css">

    <link href="/assets/favicon.ico" rel="icon" type="image/x-icon">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body data-spy="scroll" data-target="#myScrollspy" data-offset="160" class="spec">

     <!-- navbar -->
      <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img class="logo" alt="interledger" src="/assets/ilp_icon.png"/></a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li class="active"><a href="/overview.html">Docs</a></li>
              <li><a href="/community.html">Community</a></li>
              <li><a href="/news.html">News</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a target="_blank" href="https://github.com/interledger">Github</a></li>
            </ul>
          </div>
        </div>
      </nav>

    <!-- docs overview section -->

    <div class="container docs-wrapper">
      <div class="row">
        <div id="sidebarContent">
          <nav class="col-sm-4" id="myScrollspy">
            <ul class="nav-fixed nav nav-sidebar">
              <div class="overview-back"><a href="/overview.html"><i class="fa fa-angle-double-left" aria-hidden="true"></i> Back to Overview</a></div>
                <li class="nav-label">
                  <a href="./draft-3.html">ILP-RFC 0015 Draft 3</a>
                </li>
                <li>
                  <a href="./draft-3.html">Permalink to this Draft</a>
                </li>
                <li>
                  <a href="./">View the Latest Draft of ILP-RFC 0015</a>
                </li>
              
                <li class="nav-label">
                  <a href="#routing">Routing</a>
                </li>
              
                <li class="nav-label">
                  <a href="#address-requirements">Address Requirements</a>
                </li>
              
                <li class="nav-label">
                  <a href="#allocation-schemes">Allocation Schemes</a>
                </li>
              
                <li class="nav-label">
                  <a href="#global-allocation-scheme">Global Allocation Scheme</a>
                </li>
              
                <li>
                  <a href="#neighborhoods">Neighborhoods</a>
                </li>
              
                <li>
                  <a href="#node-address">Node Address</a>
                </li>
              
                <li>
                  <a href="#account-identifiers">Account Identifiers</a>
                </li>
              
                <li>
                  <a href="#interactions">Interactions</a>
                </li>
              
                <li>
                  <a href="#child-nodes">Child Nodes</a>
                </li>
              
                <li>
                  <a href="#example-global-allocation-scheme-addresses">Example Global Allocation Scheme Addresses</a>
                </li>
              
            </ul>
          </nav>
        </div>
        <div class="col-sm-8 markdown-body">
                      <h1 id="ilp-addresses---v200">ILP Addresses - v2.0.0</h1>
<p class="intro"><em>ILP addresses</em> provide a way to <a href="#routing">route</a> ILP packets to their intended destination through a series of hops, including any number of ILP Connectors. (This happens after address lookup using a higher-level protocol such as <a href="../0009-simple-payment-setup-protocol">SPSP</a>.) Addresses are not meant to be user-facing, but allow several ASCII characters for easy debugging.</p>
<h2 id="routing">Routing</h2>
<p>Connectors maintain a <em>routing table</em>, mapping all of their peer connectors to one or more ILP addresses and address prefixes. </p>
<p>When a connector receives a prepare packet that is not addressed to itself, it finds the <a href="https://en.wikipedia.org/wiki/Longest_prefix_match">longest prefix match</a> in its routing table for the destination address. </p>
<p>The connector determines the appropriate amount, and expiry, to put in the forwarded prepare packet and forwards the packet, with these new values, to the peer that it matched from the routing table. </p>
<p>Later the connector MUST be able to match the fulfill or reject packet, returned by the peer, to the original prepare.</p>
<h2 id="address-requirements">Address Requirements</h2>
<p>ILP Addresses must meet the following requirements:</p>
<ol>
<li>The address MUST begin with a prefix indicating the allocation scheme. See <a href="#allocation-schemes">Allocation Schemes</a> for more information.</li>
<li>Each &quot;segment&quot; of the address MUST contain one or more of the following characters:<ul>
<li>Alphanumeric characters, upper or lower case. (Addresses are <strong>case-sensitive</strong> so that they can contain data encoded in formats such as base64url.)</li>
<li>Underscore (<code>_</code>)</li>
<li>Tilde (<code>~</code>)</li>
<li>Hyphen (<code>-</code>)</li>
</ul>
</li>
<li>Each segment MUST be separated from other segments by a period character (<code>.</code>).</li>
<li>Addresses MUST NOT end in a period (<code>.</code>) character, and MUST contain at least one segment after the allocation scheme prefix.</li>
<li>The total length of an ILP Address must be no more than <strong>1023 characters</strong> including the allocation scheme prefix, separators, and all segments.</li>
</ol>
<p>The following ABNF specification defines the format for the contents of all ILP addresses and address prefixes. (You must also enforce the overal length requirement of 1023 characters or less.)</p>
<pre><code class="lang-abnf">address     = scheme 1*( separator segment )

scheme      = &quot;g&quot; / &quot;private&quot; / &quot;example&quot; / &quot;peer&quot; / &quot;self&quot; /
              &quot;test&quot; / &quot;test1&quot; / &quot;test2&quot; / &quot;test3&quot;

separator   = &quot;.&quot;

segment     = 1*( ALPHA / DIGIT / &quot;_&quot; / &quot;~&quot; / &quot;-&quot; )
</code></pre>
<p>You can also use the following regular expressions to verify the same requirements:</p>
<pre><code>(?=^.{1,1023}$)^(g|private|example|peer|self|test[1-3]?)([.][a-zA-Z0-9_~-]+)+$
</code></pre><p>(If your regular expression engine does not support lookahead, you must drop the first parenthesis and separately enforce the overall length requirement of 1023 characters or less.)</p>
<h2 id="allocation-schemes">Allocation Schemes</h2>
<p>The allocation scheme is the first part of an address, which indicates how the address is assigned. Here is a summary of the prefixes that are currently defined:</p>
<table class="table table-striped">
<thead>
<tr>
<th style="text-align:left">Prefix</th>
<th style="text-align:left">Allocation Scheme</th>
<th style="text-align:left">Definition and Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>g.</code></td>
<td style="text-align:left"><a href="#global-allocation-scheme">Global Allocation Scheme</a></td>
<td style="text-align:left">ILP addresses that are intended to send and receive money from any other address in the global scheme.</td>
</tr>
<tr>
<td style="text-align:left"><code>private.</code></td>
<td style="text-align:left">Private allocation</td>
<td style="text-align:left">For ILP addresses that only have meaning in a private subnet or intranet. Analogous to the <a href="https://en.wikipedia.org/wiki/Private_network">192.168.0.0/16 range in IPv4</a>.</td>
</tr>
<tr>
<td style="text-align:left"><code>example.</code></td>
<td style="text-align:left">Examples</td>
<td style="text-align:left">For &quot;non-real&quot; addresses that are used as examples or in documentation. Analogous to <a href="https://en.wikipedia.org/wiki/555_%28telephone_number%29">&quot;555 phone numbers&quot;</a> in the USA.</td>
</tr>
<tr>
<td style="text-align:left"><code>test.</code>, <code>test1.</code>, <code>test2.</code>, <code>test3.</code></td>
<td style="text-align:left">Interledger testnet and testing</td>
<td style="text-align:left">For addresses used on the public Interledger testnet and in local tests, such as unit or integration tests of compatible software.</td>
</tr>
<tr>
<td style="text-align:left"><code>local.</code></td>
<td style="text-align:left">Connector-local</td>
<td style="text-align:left">For addresses that are only valid in the context of a local connector. Analogous to <a href="https://en.wikipedia.org/wiki/Link-local_address">link-local addresses</a> in IP. Connectors can use addresses with the <code>local.</code> prefix to exchange packets within their own administrative domain, e.g. among a cluster of connectors operated by the same entity.</td>
</tr>
<tr>
<td style="text-align:left"><code>peer.</code></td>
<td style="text-align:left">Peering</td>
<td style="text-align:left">Addresses for exchange of packets only with a direct peer. Connectors MUST NOT forward packets with <code>peer.</code> addresses. Packets exchanged between peers to pass routing and config information will use <code>peer.</code> addresses.</td>
</tr>
<tr>
<td style="text-align:left"><code>self.</code></td>
<td style="text-align:left">Local loopback</td>
<td style="text-align:left">For addresses that are only valid on the local machine.</td>
</tr>
</tbody>
</table>
<h2 id="global-allocation-scheme">Global Allocation Scheme</h2>
<p>The global allocation scheme for ILP Addresses is the scheme that most addresses are expected to use. It uses the prefix <code>g.</code>. Addresses under this scheme are expected to be connected to all other such addresses, to the extent that the current trust and liquidity permit.</p>
<p>This scheme has no central issuing authority or mechanism, so more than one entity can use the same address. In this case, some connectors may prepare a route to a different account than intended. In this failure case, no money moves because the receiver does not send the fulfillment. Participants in the interledger can reduce the chances of encountering this failure case by choosing addresses carefully and by properly managing connectors&apos; routing tables.</p>
<p>The global allocation scheme does not allow you to make any assumptions about the meaning of the segments. Segments in the same place could have different meanings to different connectors. However, to make routing work well, we recommend placing segments in the following order:</p>
<ul>
<li><a href="#neighborhoods">Neighborhoods</a></li>
<li><a href="#account-identifiers">Account identifiers</a></li>
<li><a href="#interactions">Interactions</a></li>
</ul>
<p>Not all addresses contain all this information, and some addresses may use multiple segments to represent some of this information. </p>
<h3 id="neighborhoods">Neighborhoods</h3>
<p><em>Neighborhoods</em> are leading segments with no specific meaning, whose purpose is to help route to the right area. At this time, there is no official list of neighborhoods, but the following list of examples should illustrate what might constitute a neighborhood:</p>
<ul>
<li><code>crypto.</code> for ledgers related to decentralized crypto-currencies such as Bitcoin, Etherium, or XRP.</li>
<li><code>sepa.</code> for ledgers in the <a href="https://en.wikipedia.org/wiki/Single_Euro_Payments_Area">Single Euro Payments Area</a>.</li>
<li><code>dev.</code> for Interledger Protocol development and early adopters</li>
</ul>
<p>The goal of neighborhoods is to group connectors and ledgers that know about each other, so that routing is more efficient. If a neighborhood is too large or not well-connected, it can be further subdivided into nested sub-neighborhoods. For example, if the <code>dev.</code> neighborhood contains too many routes to store efficiently, or if the ledgers in that neighborhood tend only to be connected to other ledgers from the same country, development ledgers hosted in Luxembourg might choose <code>dev.luxembourg.</code> as a more closely-knit neighborhood.</p>
<h3 id="node-address">Node Address</h3>
<p>The primary function of the ILP address is to facilitate routing of packets to a node on the network. At least one segment must address the node itself. The node address can be multiple segments, which can be useful if the node is a <a href="#child-nodes">child</a> of a parent connector whose own node address will often prefix the child address.</p>
<h3 id="account-identifiers">Account Identifiers</h3>
<p>The <em>account identifiers</em> are one or more segments that serve as a unique identifier of an account held by a connector. The connector maps these to accounts it holds with peers.</p>
<h3 id="interactions">Interactions</h3>
<p><em>Interactions</em> are additional segments after the account identifier portion of an address. Senders and receivers may use a segment (or segments) of an address to indentify contextual properties of the packet exchange.</p>
<p>As an example, the sender may encode the identifier of a shared key in the address allowing the receiver to select the correct key to use for decrypting and/or fulfilling the packet.</p>
<h3 id="child-nodes">Child Nodes</h3>
<p>A node can be addressed relative to another <em>&quot;parent&quot;</em> connector. Smaller and lesser-known connectors may find it easier to advertise routes to themselves in this manner. That way, rather than needing to have their address known to every connector in the same large neighborhood, only the parent connector needs to know how to route to the smaller node.</p>
<p>In most cases a child node will use <a href="#">ILDCP</a> to get its address from its parent immediately after it has established a connection.</p>
<h3 id="example-global-allocation-scheme-addresses">Example Global Allocation Scheme Addresses</h3>
<p><code>g.acme.bob</code> - a destination address to the account &quot;bob&quot; held with the connector &quot;acme&quot;.</p>
<p><code>g.us-fed.ach.0.acmebank.swx0a0.acmecorp.sales.199.~ipr.cdfa5e16-e759-4ba3-88f6-8b9dc83c1868.2</code> - destination address for a particular invoice, which can break down as follows:</p>
<ul>
<li>Neighborhoods: <code>us-fed.</code>, <code>ach.</code>, <code>0.</code></li>
<li>Account identifiers: <code>acmebank.</code>, <code>swx0a0.</code>, <code>acmecorp.</code>, <code>sales</code>, <code>199</code> (An ACME Corp sales account at ACME Bank)</li>
<li>Interactions: <code>~ipr</code>, <code>cdfa5e16-e759-4ba3-88f6-8b9dc83c1868</code>, <code>2</code></li>
</ul>

        </div>
      </div>

    </div> <!-- /container -->

    <footer>
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="col-sm-4 col-xs-12">
              <p>Interledger Team</p>
            </div>
            <div class="col-sm-4 col-xs-12">
              <p class="text-center">See list of <a target="_blank" href="https://www.w3.org/community/interledger/participants">Contributors</a></p>
            </div>
            <div class="col-sm-4 col-xs-12">
              <p class="pull-right">Documentation licensed under <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0.</a></p>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-68500608-1', 'auto');
      ga('send', 'pageview');

    </script>
    <script src="/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

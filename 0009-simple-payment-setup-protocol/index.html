<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Payments across payment networks">

    <title>Simple Payment Setup Protocol (SPSP) | Interledger</title>

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles -->
    <link href="/css/monokai-sublime.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Google fonts -->
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,600,700|Droid+Sans+Mono|Titillium+Web:400,300,600' rel='stylesheet' type='text/css'>

    <!-- Font awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css">

    <link href="/assets/favicon.ico" rel="icon" type="image/x-icon">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body data-spy="scroll" data-target="#myScrollspy" data-offset="160" class="spec">

     <!-- navbar -->
      <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><img class="logo" alt="interledger" src="/assets/ilp_icon.png"/></a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li class="active"><a href="/overview.html">Docs</a></li>
              <li><a href="/community.html">Community</a></li>
              <li><a href="/news.html">News</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a target="_blank" href="https://github.com/interledger">Github</a></li>
            </ul>
          </div>
        </div>
      </nav>

    <!-- docs overview section -->

    <div class="container docs-wrapper">
      <div class="row">
        <div id="sidebarContent">
          <nav class="col-sm-4" id="myScrollspy">
            <ul class="nav-fixed nav nav-sidebar">
              <div class="overview-back"><a href="/overview.html"><i class="fa fa-angle-double-left" aria-hidden="true"></i> Back to Overview</a></div>
              
                <li class="nav-label">
                  <a href="#stages">Stages</a>
                </li>
              
                <li>
                  <a href="#discovery">Discovery</a>
                </li>
              
                <li>
                  <a href="#query">Query</a>
                </li>
              
                <li>
                  <a href="#quoting">Quoting</a>
                </li>
              
                <li>
                  <a href="#setup">Setup</a>
                </li>
              
                <li>
                  <a href="#execution">Execution</a>
                </li>
              
            </ul>
          </nav>
        </div>
        <div class="col-sm-8 markdown-body">
          <h1 id="simple-payment-setup-protocol-spsp">Simple Payment Setup Protocol (SPSP)</h1>
<p class="intro">The Simple Payment Setup Protocol (SPSP) is a basic application-layer Interledger protocol for wallet-to-wallet or wallet-to-merchant payments.</p>
<h2 id="stages">Stages</h2>
<p>SPSP performs its function in five stages:</p>
<ol>
<li>Discovery</li>
<li>Query</li>
<li>Quoting</li>
<li>Setup</li>
<li>Execution</li>
</ol>
<h3 id="discovery">Discovery</h3>
<p>Whenever possible, URIs should be exchanged out-of-band and discovery should be skipped. However, in some cases, it may be useful to have a standardized user-friendly identifier. This discovery method describes how to resolve such an identifier to a queryable SPSP endpoint.</p>
<p>First, the sender uses Webfinger (<a href="https://tools.ietf.org/html/rfc7033">RFC 7033</a>) to look up an identifier (e.g. <code>bob@red.ilpdemo.org</code>):</p>
<pre><code class="lang-http">GET /.well-known/webfinger?resource=acct%3Abob%40red.ilpdemo.org HTTP/1.1
Host: red.ilpdemo.org
Accept: application/json
</code></pre>
<pre><code class="lang-http">HTTP/1.1 200 OK
Content-Type: application/json

{
  &quot;subject&quot;: &quot;acct:bob@red.ilpdemo.org&quot;,
  &quot;links&quot;: [
    {
      &quot;rel&quot;: &quot;https://interledger.org/rel/receiver&quot;,
      &quot;href&quot;: &quot;https://red.ilpdemo.org/api/receivers/bob&quot;
    }
  ]
}
</code></pre>
<p><a href="https://red.ilpdemo.org/.well-known/webfinger?resource=acct%3Abob%40red.ilpdemo.org">Try this request</a></p>
<h3 id="query">Query</h3>
<p>Any SPSP recipient will create a receiving endpoint called the <em>receiver</em>. The sender queries this endpoint to get information about the type of payment that can be made to this receiver:</p>
<pre><code class="lang-http">GET /api/receivers/bob HTTP/1.1
Host: red.ilpdemo.org
Accept: application/json
</code></pre>
<pre><code class="lang-http">HTTP/1.1 200 OK
Content-Type: application/json

{
  &quot;type&quot;: &quot;payee&quot;,
  &quot;ledger&quot;: &quot;https://red.ilpdemo.org/ledger&quot;,
  &quot;account&quot;: &quot;https://red.ilpdemo.org/ledger/accounts/bob&quot;,
  &quot;payments&quot;: &quot;https://red.ilpdemo.org/api/receiver/bob/payments&quot;
}
</code></pre>
<p><a href="https://red.ilpdemo.org/api/receivers/bob">Try this request</a></p>
<p>Possible values for <code>type</code> are:</p>
<p><code>payee</code>
: This is a general receiving account for peer-to-peer payments.</p>
<p><code>invoice</code>
: This is an invoice, meaning it can be paid only once and only with a specific amount.</p>
<h4 id="payee">Payee</h4>
<p>Payee information consists of basic account details. Amounts are chosen by the sender.</p>
<p><strong>Example Receiver</strong></p>
<pre><code class="lang-json">{
  &quot;type&quot;: &quot;payee&quot;,
  &quot;ledger&quot;: &quot;https://red.ilpdemo.org/ledger&quot;,
  &quot;account&quot;: &quot;https://red.ilpdemo.org/ledger/accounts/bob&quot;,
  &quot;payments&quot;: &quot;https://red.ilpdemo.org/api/receiver/bob/payments&quot;
}
</code></pre>
<p>If this receiver is not available, an error can be generated at this stage:</p>
<pre><code class="lang-http">HTTP/1.1 404 Not Found
Content-Type: application/json

{
  &quot;id&quot;: &quot;InvalidReceiverIdError&quot;,
  &quot;message&quot;: &quot;Invalid receiver ID&quot;
}
</code></pre>
<h4 id="invoice">Invoice</h4>
<p>Invoice information includes an exact amount as well as the status of the invoice. (Invoices can only be paid once.)</p>
<p><strong>Example Receiver</strong></p>
<pre><code class="lang-json">{
  &quot;type&quot;: &quot;invoice&quot;,
  &quot;ledger&quot;: &quot;https://red.ilpdemo.org/ledger&quot;,
  &quot;account&quot;: &quot;https://red.ilpdemo.org/ledger/accounts/amazon&quot;,
  &quot;amount&quot;: &quot;10.40&quot;,
  &quot;status&quot;: &quot;unpaid&quot;,
  &quot;invoice_info&quot;: &quot;https://www.amazon.com/gp/your-account/order-details?ie=UTF8&amp;orderID=111-7777777-1111111&quot;,
  &quot;payments&quot;: &quot;https://red.ilpdemo.org/api/invoice_receiver/amazon/111-7777777-1111111/payments&quot;
}
</code></pre>
<h3 id="quoting">Quoting</h3>
<p>The sender requests quotes from neighboring connectors using <a href="../0008-interledger-quoting-protocol/">ILQP</a>.</p>
<h3 id="setup">Setup</h3>
<p>When the sender is ready to make a payment, it submits a payment object to the receiver:</p>
<pre><code class="lang-http">POST /api/receiver/bob/payments HTTP/1.1
Host: red.ilpdemo.org
Accept: application/json

{
  &quot;amount&quot;: &quot;10.40&quot;,
  &quot;source_identifier&quot;: &quot;alice@blue.ilpdemo.org&quot;,
  &quot;memo&quot;: &quot;Hey Bob!&quot;
}
</code></pre>
<pre><code class="lang-http">HTTP/1.1 201 Created
Content-Type: application/json

{
  &quot;receipt_condition&quot;: &quot;cc:1:1:47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU:1&quot;
}
</code></pre>
<p>The setup is what primes the receiver to expect the incoming payment. It also provides the sender with the correct execution condition which describes the signed receipt which the receiver will generate to provide proof-of-payment.</p>
<p>The receiver has the opportunity to reject an incoming payment before any funds move, for instance because of daily limits:</p>
<pre><code class="lang-http">HTTP/1.1 422 Unprocessable Entity
Content-Type: application/json

{
  &quot;id&quot;: &quot;LimitExceededError&quot;,
  &quot;error&quot;: &quot;Daily incoming funds limit exceeded&quot;
}
</code></pre>
<h3 id="execution">Execution</h3>
<p>The sender initiates a transfer on their local ledger using <a href="../0006-universal-transport-protocol/">UTP</a>.</p>

        </div>
      </div>

    </div> <!-- /container -->

     <footer>
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <div class="col-xs-4">
                <p>Interledger Team</p>
              </div>
              <div class="col-xs-4">
                <p class="text-center">See list of <a href="https://www.w3.org/community/interledger/participants">Contributors</a></p>
              </div>
              <div class="col-xs-4">
                <p class="pull-right">Documentation licensed under <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0.</a></p>
              </div>
            </div>
          </div>
        </div>
      </footer>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-68500608-1', 'auto');
      ga('send', 'pageview');

    </script>
    <script src="/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
